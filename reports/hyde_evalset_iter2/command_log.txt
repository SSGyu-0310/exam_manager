branch: feature/db-ops-safety
commit: f202ef163fc0515881a4670681e433dfd5807816
code changes:
- scripts/build_queries.py: added --question-ids-file support (evalset-only) and .env load
- scripts/evaluate_evalset.py: added --question-ids-file filter
- app/services/retrieval.py: HyDE BM25 variants + stopword filtering + best_of_two strategy
- config.py: HYDE_STRATEGY / HYDE_BM25_VARIANT / HYDE_NEGATIVE_MODE / HYDE_MARGIN_EPS

commands:
1) extract evalset ids -> evalset_question_ids.txt
   python - << (SQL: evaluation_labels where gold_lecture_id IS NOT NULL and is_ambiguous=0)
2) build HyDE cache (evalset only)
   .\.venv\Scripts\python.exe scripts\build_queries.py --provider gemini --concurrency 10 --force --question-ids-file evalset_question_ids.txt
3) verify cache count for evalset
   sqlite query count(question_queries where question_id in evalset ids)
4) weight sweep (HYDE_ENABLED=1, HYDE_STRATEGY=blend, HYDE_BM25_VARIANT=mixed_light, HYDE_NEGATIVE_MODE=stopwords)
   - HYDE_EMBED_WEIGHT=0.0 HYDE_EMBED_WEIGHT_ORIG=1.0 -> reports\eval_20260115_135702 -> results_evalset_weights_0p0_1p0
   - HYDE_EMBED_WEIGHT=0.3 HYDE_EMBED_WEIGHT_ORIG=0.7 -> reports\eval_20260115_135856 -> results_evalset_weights_0p3_0p7
   - HYDE_EMBED_WEIGHT=0.5 HYDE_EMBED_WEIGHT_ORIG=0.5 -> reports\eval_20260115_140049 -> results_evalset_weights_0p5_0p5
   - HYDE_EMBED_WEIGHT=0.7 HYDE_EMBED_WEIGHT_ORIG=0.3 -> reports\eval_20260115_140248 -> results_evalset_weights_0p7_0p3
   - HYDE_EMBED_WEIGHT=1.0 HYDE_EMBED_WEIGHT_ORIG=0.0 -> reports\eval_20260115_140445 -> results_evalset_weights_1p0_0p0
5) BM25 variants (weights fixed at 0.3/0.7)
   - HYDE_BM25_VARIANT=orig_only -> reports\eval_20260115_140654 -> results_evalset_bm25_orig_only
   - HYDE_BM25_VARIANT=hyde_only -> reports\eval_20260115_140740 -> results_evalset_bm25_hyde_only
   - HYDE_BM25_VARIANT=mixed_light -> reuse results_evalset_weights_0p3_0p7
6) best-of-two strategy
   - HYDE_STRATEGY=best_of_two, HYDE_BM25_VARIANT=orig_only -> reports\eval_20260115_140940 -> results_evalset_best_of_two
