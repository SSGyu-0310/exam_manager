# =============================================================================
# Core Settings
# =============================================================================
# Flask secret key (프로덕션에서는 반드시 변경)
SECRET_KEY=dev-secret-key-change-in-production

# JWT secret key (프로덕션에서는 반드시 변경, 32바이트 이상 권장)
JWT_SECRET_KEY=dev-jwt-secret-key-change-in-production-32

# 로그인 유지 시간(분). 기본 720분(12시간)
# JWT_ACCESS_TOKEN_EXPIRES_MINUTES=720
# 만료 임박(남은 시간) 기준 자동 재발급 윈도우(분)
# JWT_REFRESH_WINDOW_MINUTES=30

# 실행 프로파일 선택
# 개발: FLASK_CONFIG=development
# 운영: FLASK_CONFIG=production
FLASK_CONFIG=development
FLASK_DEBUG=1


# =============================================================================
# Database Operations
# =============================================================================
# Postgres 연결 (필수)
# 로컬 dev 기본 예시 (docker db + host backend):
# DATABASE_URL=postgresql+psycopg://exam:exam_dev_password@127.0.0.1:5432/exam_manager_dev
# DATABASE_URL=postgresql+psycopg://user:pass@host:5432/dbname
# scripts/dev-test-backend에서 사용할 test DB 이름 (기본: ${POSTGRES_DB}_test)
# POSTGRES_TEST_DB=exam_manager_test

# Local admin 전용 DB (필요 시 지정)
# LOCAL_ADMIN_DATABASE_URL=postgresql+psycopg://user:pass@host:5432/admin_db

# SQLAlchemy 풀 옵션 (Postgres에서만 적용)
# DB_POOL_SIZE=5
# DB_MAX_OVERFLOW=10
# DB_POOL_RECYCLE=1800

# 요청 본문 최대 크기 (bytes, 기본 100MB)
# MAX_CONTENT_LENGTH=104857600

# DB 자동 생성 (개발 편의; DevelopmentConfig 기본 True)
# AUTO_CREATE_DB=1

# DB 읽기 전용 모드 (쓰기 금지)
# DB_READ_ONLY=0

# 앱 시작 시 미적용 마이그레이션 감지
# CHECK_PENDING_MIGRATIONS=1

# 프로덕션에서 미적용 마이그레이션 있으면 중단
# FAIL_ON_PENDING_MIGRATIONS=0

# 관리자 라우트 접근 제한 (localhost만 허용)
# LOCAL_ADMIN_ONLY=0

# CORS 허용 Origin 목록 (쉼표 구분)
# CORS_ALLOWED_ORIGINS=http://localhost:4000

# =============================================================================
# Backup
# =============================================================================
# 쓰기 전 핫백업 수행
# AUTO_BACKUP_BEFORE_WRITE=0

# 백업 유지 개수
# AUTO_BACKUP_KEEP=30

# 백업 디렉토리
# AUTO_BACKUP_DIR=./backups

# 프로덕션에서 백업 강제
# ENFORCE_BACKUP_BEFORE_WRITE=0


# =============================================================================
# AI Classification (Gemini)
# =============================================================================
# 조건부: AI 기능 사용 시 필요
# GEMINI_API_KEY=your_api_key_here

# Gemini 모델명
# GEMINI_MODEL_NAME=gemini-2.0-flash-lite

# AI 자동 적용
# AI_AUTO_APPLY=0

# Gemini 최대 출력 토큰
# GEMINI_MAX_OUTPUT_TOKENS=2048


# =============================================================================
# Classifier Cache
# =============================================================================
# 분류기 캐시 경로
# CLASSIFIER_CACHE_PATH=./data/classifier_cache.json


# =============================================================================
# Auto-Confirm V2 (Classifier Enhancement)
# =============================================================================
# AUTO_CONFIRM_V2_ENABLED=1
# AUTO_CONFIRM_V2_DELTA=0.05
# AUTO_CONFIRM_V2_MAX_BM25_RANK=5
# AUTO_CONFIRM_V2_DELTA_UNCERTAIN=0.03
# AUTO_CONFIRM_V2_MIN_CHUNK_LEN=200


# =============================================================================
# Context Expansion
# =============================================================================
# Parent Context Expansion
# PARENT_ENABLED=0
# PARENT_WINDOW_PAGES=1
# PARENT_MAX_CHARS=3500
# PARENT_TOPK=5

# Semantic Expansion
# SEMANTIC_EXPANSION_ENABLED=1
# SEMANTIC_EXPANSION_TOP_N=6
# SEMANTIC_EXPANSION_MAX_EXTRA=2
# SEMANTIC_EXPANSION_QUERY_MAX_CHARS=1200


# =============================================================================
# Retrieval & Search
# =============================================================================
# Retrieval mode: bm25
# RETRIEVAL_MODE=bm25

# Search backend switch: auto | postgres
# SEARCH_BACKEND=postgres

# Postgres tsquery mode: websearch | plainto | to_tsquery
# SEARCH_PG_QUERY_MODE=websearch

# Optional pg_trgm fallback (Postgres only)
# SEARCH_PG_TRGM_ENABLED=0
# SEARCH_PG_TRGM_MIN_SIMILARITY=0.2
# SEARCH_PG_TRGM_TOP_N=40

# HYDE (Hypothetical Document Embeddings)
# HYDE_ENABLED=0
# HYDE_AUTO_GENERATE=0
# HYDE_PROMPT_VERSION=hyde_v1
# HYDE_MODEL_NAME=
# HYDE_STRATEGY=blend
# HYDE_BM25_VARIANT=mixed_light
# HYDE_NEGATIVE_MODE=stopwords
# HYDE_MARGIN_EPS=0.0
# HYDE_MAX_KEYWORDS=7
# HYDE_MAX_NEGATIVE=6


# =============================================================================
# PDF Processing
# =============================================================================
# PDF 파서 모드: legacy | experimental
# PDF_PARSER_MODE=legacy

# Classifier post-process hardening
# CLASSIFIER_ALLOW_ID_FROM_TEXT=0
# CLASSIFIER_REQUIRE_VERBATIM_QUOTE=1
# CLASSIFIER_REQUIRE_PAGE_SPAN=1
# CLASSIFIER_DEBUG_LOG=0
